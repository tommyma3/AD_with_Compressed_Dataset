include: config/model/ad_base.yaml

model: AD

# Compressed Context Mode
use_compressed_context: true
compress_interval: 80  # Should match n_steps from PPO config

# Transformer
tf_n_embd: 64
tf_n_layer: 4
tf_n_head: 4
tf_dropout: 0.1
tf_attn_dropout: 0.1
tf_n_inner: 128
n_transit: 328  # 4 compression regions (4 * 82 tokens/region) for sampling flexibility during training

# training
lr: 0.0003  
train_batch_size: 512
test_batch_size: 2048
train_source_timesteps: 1000
train_timesteps: 50000
num_warmup_steps: 1000  

# Multi-GPU training settings
mixed_precision: 'no'  # Options: 'no', 'fp16', 'bf16' (use 'fp16' for faster training on GPUs)
gradient_accumulation_steps: 1  # Increase if you run out of memory

num_workers: 4
